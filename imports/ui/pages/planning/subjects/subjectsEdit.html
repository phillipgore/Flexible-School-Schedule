<template name="subjectsEdit">
	{{> dialog}}
	
	<main class="app-content app-content-preceeds-toolbar app-content-form">
		<form class="js-form-subjects-update row">

			<h2 class="m-tn-b-9">Step 1: Information</h2>
			<div class="well bg-gray-lighter m-tn-b-18">
				<label>Subject Name</label>
				<input type="text" name="name" id="name" placeholder="Math" autocomplete="off" value="{{subject.name}}">
				<label>Descripton</label>
				<textarea class="m-tn-b-neg-3" name="description" id="description" placeholder="Learn basic mathematics..." rows="4" value="{{subject.description}}"></textarea>
			</div>

			<h2 class="m-tn-t-36 m-tn-b-9">Step 2: Resources</h2>
			<label>Search To Attach Resources</label>
			<div class="pos-relative">
				<div class="icn-overlay">
					<input type="text" name="searchResources" id="search-resources" placeholder="Search Resources" autocomplete="off">
					<div class="icn-left">
						{{#if searching}}
						<i class="fss-searching fss-spin"></i>
						{{else}}
						<i class="fss-search"></i>
						{{/if}}
					</div>
					<a href="#" class="js-clear-search icn-right">
						<div class="btn btn-circle bg-danger small">
							<i class="fss-close"></i>
						</div>
					</a>
				</div>
				
				{{#if query}}
				<ul class="list list-search-results">
					{{#each resource in resources}}
					<li class="list-item">
						<div class="list-item-inner p-tn-rl-9">
							<div class="list-item-icon"><i class="fss-{{resource.type}} txt-primary"></i></div>
							<div class="list-item-label txt-ellipsis">{{resource.title}}</div>
							<div class="list-item-btn">
								<a id="{{resource._id}}" href="#" class="js-add-resource btn btn-circle small">
									<i class="fss-new"></i>
								</a>
							</div>
						</div>
					</li>
					{{else}}
					<li class="list-item p-tn-rl-9">
						<div class="list-item-inner">No Results.</div>
					</li>
					{{/each}}
				</ul>
				{{/if}}
			</div>

			<div class="well bg-gray-lighter p-tn-b-0 m-tn-b-18">
				<label class="m-tn-b-9">Attached Resources</label>
				<ul class="list">
					{{#each resource in localResources}}
					<li class="list-item">
						<div class="list-item-inner dark-border top-border p-tn-rl-9 m-tn-rl-neg-9">
							<input type="hidden" name="resourceId" id="resource-id" value="{{resource.id}}">
							<div class="list-item-icon"><i class="fss-{{resource.type}} txt-primary"></i></div>
							<div class="list-item-label">{{resource.title}}</div>
							<div class="list-item-btn">
								<a id="{{resource.id}}" href="#" class="js-remove-resource btn btn-circle bg-danger small">
									<i class="fss-close"></i>
								</a>
							</div>
						</div>
					</li>
					{{else}}
					<li class="list-item">
						<div class="list-item-inner dark-border top-border txt-tn-center p-tn-rl-9 m-tn-rl-neg-9">
							No Attached Resources
						</div>
					</li>
					{{/each}}
				</ul>
			</div>

			<h2 class="m-tn-t-36 m-tn-b-9">Step 3: Schedule</h2>
			{{#each term in terms}}
			<div id="{{term._id}}" class="well bg-gray-lighter m-tn-b-9">
				<h3 class="m-tn-b-9">Term {{term.order}}: Times Per Week</h3>
				<label>Preset All Weeks To</label>
				<div class="fss-select">
					<select data-term-id="{{term._id}}" class="js-times-per-week-preset" name="timesPerWeekPreset" id="times-per-week-preset">
						<option disabled selected value>Preset Options</option>
						<option value="">0 Times Per Week</option>
						<option value="1">1 Time Per Week</option>
						<option value="2">2 Times Per Week</option>
						<option value="3">3 Times Per Week</option>
						<option value="4">4 Times Per Week</option>
						<option value="5">5 Times Per Week</option>
						<option value="6">6 Times Per Week</option>
						<option value="7">7 Times Per Week</option>
					</select>
				</div>
				<div class="row m-tn-rl-neg-3 m-tn-b-neg-12">
					{{#each week in weeks term._id}}
					<div class="col-tn-1of5 p-tn-rl-3">
						<label>Week {{week.order}}</label>
						<input data-term-id="{{term._id}}" data-week-id="{{week._id}}" class="js-times-per-week" type="number" name="timesPerWeek" placeholder="5" autocomplete="off" maxlength="2" value="{{lessonCount week._id}}">
					</div>
					{{/each}}
				</div>
			</div>
			{{/each}}

			<footer class="toolbar toolbar-bottom toolbar-gray m-tn-t-27">
				<a href="{{cancelPath}}" class="btn btn-gray-darker fl-tn-left">Cancel</a>
				<button type="submit" class="js-submit fl-tn-right">Update</button>
			</footer>
		</form>
	</main>
	{{#unless Template.subscriptionsReady}}
		{{> loading}}
	{{/unless}}
	{{> updating}}
</template>