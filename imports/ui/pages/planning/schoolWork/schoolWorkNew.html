<template name="schoolWorkNew">
	
	<main class="app-content app-content-preceeds-toolbar app-content-form">
		<form class="js-form-school-work-new row">
			<h2 class="m-tn-b-9">Step 1: Information</h2>
			<label class="m-tn-b-6">Students</label>
			{{#each student in students}}
				<div>
					<label class="checkbox">
						<input class="js-checkbox js-student-id" type="checkbox" name="studentId" id="{{student._id}}" value="{{isChecked student._id}}" checked="{{isChecked student._id}}">
						<div class="checkbox-icon"></div> 
						<div class="checkbox-label">{{student.preferredFirstName.name}} {{student.lastName}}</div>
					</label>
				</div>
			{{/each}}
			<label id="studentId-error" class="student-error hide" for="studentId">At least one student must be checked.</label>
			<div class="well bg-gray-lighter m-tn-b-18">
				<label>School Work Name</label>
				<input type="text" name="name" id="name" placeholder="Math" autocomplete="off">
				<label>Descripton / General Plan</label>
				{{> editor placeholder="Read a chapter a day..."}}
			</div>

			<h2 class="m-tn-t-36 m-tn-b-9">Step 2: Resources</h2>
			<label>Search To Attach Resources</label>
			<div class="pos-relative">
				<div class="icn-overlay">
					<input type="text" name="searchResources" id="search-resources" placeholder="Search Resources" autocomplete="off">
					<div class="icn-left">
						{{#if searching}}
						<div class="loader-icon loader-icon-on-white loader-icon-tn"></div>
						{{else}}
						<i class="fss-search"></i>
						{{/if}}
					</div>
					<a href="#" class="js-clear-search icn-right">
						<div class="btn btn-circle bg-danger small">
							<i class="fss-close"></i>
						</div>
					</a>
				</div>
				
				{{#if query}}
				<ul class="list list-search-results">
					{{#each resource in resources}}
					<li class="list-item">
						<div class="list-item-inner p-tn-rl-9">
							<div class="list-item-icon"><i class="fss-{{resource.type}} txt-primary"></i></div>
							<div class="list-item-label txt-ellipsis">{{resource.title}}</div>
							<div class="list-item-btn">
								<a id="{{resource._id}}" href="#" class="js-add-resource btn btn-circle small">
									<i class="fss-new"></i>
								</a>
							</div>
						</div>
					</li>
					{{else}}
					<li class="list-item p-tn-rl-9">
						<div class="list-item-inner">No Results.</div>
					</li>
					{{/each}}
				</ul>
				{{/if}}
			</div>

			<div class="well bg-gray-lighter p-tn-b-0 m-tn-b-18">
				<label class="m-tn-b-9">Attached Resources</label>
				<ul class="list">
					{{#each resource in localResources}}
					<li class="list-item">
						<div class="list-item-inner dark-border top-border p-tn-rl-9 m-tn-rl-neg-9">
							<input type="hidden" name="resourceId" id="resource-id" value="{{resource.id}}">
							<div class="list-item-icon"><i class="fss-{{resource.type}} txt-primary"></i></div>
							<div class="list-item-label">{{resource.title}}</div>
							<div class="list-item-btn">
								<a id="{{resource.id}}" href="#" class="js-remove-resource btn btn-circle bg-danger small">
									<i class="fss-close"></i>
								</a>
							</div>
						</div>
					</li>
					{{else}}
					<li class="list-item">
						<div class="list-item-inner dark-border top-border txt-tn-center p-tn-rl-9 m-tn-rl-neg-9">
							No Attached Resources
						</div>
					</li>
					{{/each}}
				</ul>
			</div>

			<h2 class="m-tn-t-36 m-tn-b-9">Step 3: Schedule</h2>
			<label class="m-tn-b-3">School Year</label>
			<div class="fss-select">
				<select class="js-school-year-select" name="schoolYearId">
					{{#each schoolYear in schoolYears}}
						<option value="{{schoolYear._id}}" {{isSelected schoolYear._id}}>{{schoolYear.startYear}}-{{schoolYear.endYear}}</option>
					{{/each}}
				</select>
			</div>
			{{#each term in terms}}
			<div id="{{term._id}}" class="well bg-gray-lighter m-tn-b-9">
				<h3 class="m-tn-b-9">Term {{term.order}}</h3>
				<label>{{weekCount term._id}} Weeks</label>
				<div class="fss-select">
					<select data-term-id="{{term._id}}" class="js-times-per-week-preset" name="timesPerWeekPreset" id="times-per-week-preset">
						<option disabled selected value>Times Per Week</option>
						<option value="">0 Times Per Week</option>
						<option value="1">1 Time Per Week</option>
						<option value="2">2 Times Per Week</option>
						<option value="3">3 Times Per Week</option>
						<option value="4">4 Times Per Week</option>
						<option value="5">5 Times Per Week</option>
						<option value="6">6 Times Per Week</option>
						<option value="7">7 Times Per Week</option>
					</select>
				</div>
				<button id="{{term.order}}" class="js-show-individual-weeks btn-gray-dark btn-block extra-small"><span class="js-label-{{term.order}}">Show</span><span class="js-label-{{term.order}} hide">Hide</span> Individual Weeks</button>
				<div class="js-times-per-week-container m-tn-rl-neg-3 m-tn-b-neg-6 m-tn-t-9">
					<div class="js-{{term.order}} row hide">
						{{#each week in weeks term._id}}
						<div class="col-tn-1of5 p-tn-rl-3">
							<label>Wk {{week.order}}</label>
							<input data-term-id="{{term._id}}" data-week-id="{{week._id}}" class="js-times-per-week" type="text" name="timesPerWeek" placeholder="5" autocomplete="off" maxlength="1">
						</div>
						{{/each}}
					</div>
				</div>
			</div>
			{{/each}}

			<footer class="toolbar toolbar-bottom toolbar-gray m-tn-t-27">
				<a href="/planning/schoolWork/view/2/{{selectedStudentId}}/{{selectedSchoolYearId}}/{{selectedSchoolWorkId}}" class="js-cancel btn btn-gray-darker fl-tn-left">Cancel</a>
				<button type="submit" class="js-submit fl-tn-right">Save</button>
			</footer>
		</form>
	</main>
	{{#unless subscriptionReady}}
		{{> loading}}
	{{/unless}}
	{{> saving}}
</template>